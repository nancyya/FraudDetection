'''
Created on Feb 13, 2014

@author: nancy
'''
import os
import re #used for regular expressions
from datetime import datetime as time

global domains; domains = dict({});


targetFilePath = '/home/nancy/Desktop/malwareList'
#sourceFilesPath = ['/data/blackLists/malwareDomains', '/home/nancy/Desktop/malwareListSafeBrowsing_2_stats_12_03_10.txt', '/home/nancy/Desktop/malwareListSafeBrowsing_150_stats_12_03_14.txt', '/home/nancy/Desktop/malwareListSafeBrowsing_550_stats_12_03_12.txt']
directory = '/home/nancy/Desktop/malwareListSafeBrowsing/'
    
def readSourceLogFilesAndExtractData(directory):
    
    Files = os.listdir(directory)
    
    for File in Files:  
    
        File = directory+File
        print(File)
        with open(File,"r") as myFile:      
            for line in myFile:
                if (File != '/home/nancy/Desktop/malwareListSafeBrowsing/malwareDomains'):
                    line = [str(s) for s in line.rstrip()[2:-2].split('\', \'')]
                else: 
                    line = [str(line.rstrip())]
                    
                for domain in line:
                    domains[domain] = 1
                
    
    print("Number of Distinct Malware Domains : " + str(len(domains)) ) 
                              
    return domains.keys()


def writeToFile(filePath, text):
        
        os.path.exists(filePath) and os.remove(filePath)
        target = open(filePath, 'a')

        for object in text:
            target.write(str(object))
            target.write('\n')
             
        target.close()
        return None       
    
class main():
    
    print "STRAT -----> " + str(time.now())
    
    running_time = time.now()
    
    
    writeToFile(targetFilePath, readSourceLogFilesAndExtractData(directory));
    
    running_time = time.now() - running_time
    
    print "END -----> " + str(time.now()) + " Total running time : %s " % str(running_time)

